{% extends 'base.html' %}
{% load waffle_tags %}
{% load markup %}

		{% block topnav %}
		<li><a href="/model/" title="Learn all about PHCX and the math behind it.">About</a></li>
		<li><a href="/contact/" title="Get in touch.">Contact</a></li>
		<li><a href="/topics/" title="These are all of the simulations available.">Topics</a></li>
		{% endblock %}

{% block content %}

<!--start 4 part topic subnav-->
<ul class="nav nav-tabs nav-justified">
<li><a href="/topic-obesity/">Introduction</a></li>
<li><a href="/pages/introduction/" title="Ramp up your understanding with this handy tutorial.">Exercises</a></li>
<li class="active"><a href="/run/new/" title="Create a new run.">Simulation</a></li>
<li><a href="/topic-obesity-debrief/">Debrief</a></li>
</ul>
<!-- stop 4 part topic subnav -->



{% flag simulation %}

<h2>Compare Runs</h2>
<table class="table table-condensed table-striped">
	<thead>
		<tr>
			<th>Run</th>
			<th>Description</th>
			<th>Number of Agents</th>
			<th>Ticks</th>
			<th>Mean mass</th>
			<th>StdDev of mass</th>
		</tr>
	</thead>
	<tbody>
{% for run in runs %}
<tr>
	<td><a href="/run/{{run.run.id}}/">{{run.run.title|default:run.run.created}}</a></td>
	<td>{{run.run.description|markdown}}</td>
	<td>{{run.number_agents}}</td>
	<td>{{run.ticks}}</td>
	<td>{{run.mean}}</td>
	<td>{{run.stddev}}</td>
</tr>
<tr>
	<td colspan="6">
		<div class="placeholder" id="graph-{{run.run.id}}"/>
	</td>
</tr>
{% endfor %}
</tbody>
</table>

{% else %}
<p>Simulation is not active yet</p>
{% endflag %}
{% endblock %}


{% block js %}
<script type="text/javascript" src="{{STATIC_URL}}js/d3.js"></script>
<script type="text/javascript" src="{{STATIC_URL}}js/graph.js"></script>

<script type="text/javascript">
var runData = [];
var runStdDevs = [];

{% for run in runs %}
runData = [];
runStdDevs = [];
{% for d in run.stats %}
runData.push({{d.mean}});runStdDevs.push({{d.std}});
{% endfor %}

makeGraph("div#graph-{{run.run.id}}", runData, runStdDevs);
{% endfor %}
</script>

{% endblock %}
